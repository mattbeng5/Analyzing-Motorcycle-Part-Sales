# Analyzing Motorcycle Part Sales

## Table of Contents
- [Project Overview](#project-overview)
- [Data Source](#data-source)
- [Tools](#tools)
- [Data Validation and Cleaning](#data-validation-and-cleaning)
- [Analyzing Wholesale Revenue](#analyzing-wholesale-revenue)
- [Reducing Transaction Costs and Improving Profitability](#reducing-transaction-costs-and-improving-profitability)
- [Marketing Campaign](#marketing-campaign)
- [Conclusion](#conclusion)

## Project Overview
The objective of this project is to analyze the sales data of three warehouses selling motorcycle parts at wholesale and retail. We want to gain a better understanding of wholesale revenue by product line, and how this varies month-to-month and across warehouses. Additionally, we want to explore ways to reduce transaction costs and improve profitability. Our final task will be to aid the marketing team in finding our most popular product lines for both retail and wholesale customers to plan a targeted marketing campaign. 

## Data Source
The data file, revenue_by_product_line.csv, contains motorcycle part sales data from three seperate warehouses. 

## Tools
- SQL

## Data Validation and Cleaning
For the validation and cleaning portion of this analysis, we will proceed with the following steps:
  1. Check for null values
  2. Ensure all numeric columns are above 0
  3. Ensure no order numbers are repeated 
```SQL
-- Check for Null Values
SELECT *
FROM sales
WHERE order_number IS NULL OR
		date IS NULL OR
		warehouse IS NULL OR
		client_type IS NULL OR
		product_line IS NULL OR
		quantity IS NULL OR
		unit_price IS NULL OR
		total IS NULL OR
		payment IS NULL OR
		payment_fee IS NULL ;

--Ensure all numeric columns are above 0
SELECT *
FROM sales
WHERE quantity < 0
   OR unit_price < 0
   OR payment_fee < 0
   OR payment_fee > 1;

--Ensure no order numbers are repeated
SELECT order_number
FROM sales
GROUP BY order_number
HAVING COUNT(*) > 1;
```
There are no null values, all numeric columns are above 0, and there are no repeat order numbers. We will now continue on with our analysis.

## Analyzing Wholesale Revenue
Now, we want to find out how much wholesale revenue is generated by each product line per warehouse.
```SQL
SELECT product_line, CASE WHEN EXTRACT(MONTH FROM date) = 6 THEN 'June'
						WHEN EXTRACT (MONTH FROM date) = 7 THEN 'July'
						ELSE 'August' END AS  month, warehouse, SUM(total) - SUM(payment_fee) AS net_revenue
FROM sales
WHERE client_type = 'Wholesale'
GROUP BY product_line, month, warehouse
ORDER BY product_line, month, net_revenue DESC ; 
```
## Reducing Transaction Costs and Improving Profitability
The finance team is exploring ways to reduce transaction costs and improve profitability. They’ve asked you to determine the most profitable payment method for each warehouse in each month. Calculate the net revenue for each payment method, grouped by warehouse and month, and identify the top payment method for each combination.

```SQL
--Determine the fee of each payment type
SELECT DISTINCT payment, payment_fee
FROM sales ;

--Determine how many times each payment type used
SELECT payment, COUNT(*) AS times_used
FROM sales
GROUP BY payment
ORDER BY times_used DESC ; 

WITH ranked_revenue AS (SELECT warehouse, CASE WHEN EXTRACT(MONTH FROM date) = 6 THEN 'June' WHEN EXTRACT(MONTH FROM date) = 7 THEN 'July' ELSE 'August' END AS month, payment,ROUND(SUM(total) - SUM(payment_fee), 0) AS net_revenue, RANK() OVER(PARTITION BY warehouse, EXTRACT(MONTH FROM date) ORDER BY SUM(Total) DESC) AS rank_num
	FROM sales
	GROUP BY warehouse, EXTRACT(MONTH FROM date), payment)
SELECT warehouse, month, payment, net_revenue
FROM ranked_revenue
WHERE rank_num = 1 ;
```
## Marketing Campaign
The marketing team is planning a targeted campaign and wants to know the most popular product lines for retail and wholesale customers.

They have given you the task to find the top 3 most ordered product lines for each client type.

```SQL
WITH ranked_sales AS (SELECT client_type, product_line, SUM(quantity) AS total_quantity, RANK() OVER(PARTITION BY client_type ORDER BY SUM(quantity) DESC) AS 		rank_num
						FROM sales GROUP BY client_type, product_line)
SELECT client_type, product_line, total_quantity
FROM ranked_sales
WHERE rank_num <= 3 ;
```

## Conclusion
Across all warehouses and months, the transfer payment method was the most profitable (10% fee), compared with credit cards (30% fee) and cash (0% fee). Credit cards accounted for the majority of transactions (659), followed by transfers (225) and lastly cash (116). To boost profitability on credit‐card orders, we could pass part of the 30% processing fee on to customers. Alternatively, we might offer a small cash‐payment discount (e.g. 5%) to encourage lower‐cost transactions.
For product‐line popularity:
- Retail customers’ top three are suspension & traction (1,017 orders), electrical system (862), and braking system (862).
- Wholesale customers’ top three are braking system (1,268), suspension & traction (1,128), and frame & body (932).


